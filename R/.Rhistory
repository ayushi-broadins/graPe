ggplot(df2, aes(Freq)) +
xlim(-1,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
#geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.95* dpois(x,lambda),
args=fitdistr(df2$Freq,"poisson")$estimate, size = 1.5, color = "#00BFC4",
alpha=0.8)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-1,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
#geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.5* dpois(x,lambda),
args=fitdistr(df2$Freq,"poisson")$estimate, size = 1.5, color = "#00BFC4",
alpha=0.8)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-1,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
#geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.5* dpois(x,lambda),
args=fitdistr(df2$Freq,"poisson")$estimate,
xlim=c(-1,40), n=42, size = 1.5, color = "#00BFC4",
alpha=0.8)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-1,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
#geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.5* dpois(x,lambda),
args=fitdistr(df2$Freq,"poisson")$estimate,
xlim=c(1,20), n=20,size = 1.5, color = "#00BFC4",
alpha=0.8)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-1,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
df2$dens <- 2 * dpois(x = df2$Freq, lambda = 20)
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 1.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
df2$dens <- 3 * dpois(x = df2$Freq, lambda = 20)
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(5,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
min(df2$Freq)
ggplot(df2, aes(Freq)) +
xlim(8,40)+
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
mybinwidth = 2.4
df2 <- as.data.frame(rpois(1000, lambda = 1))
colnames(df2) <- "Freq"
df2$dens <- 3 * dpois(x = df2$Freq, lambda = 1)
df2$normdens <- mybinwidth * dnorm(df2$Freq,mean=mean(df2$Freq),sd=sd(df2$Freq))
R2.exp <- expression(paste("assay signal (",10^4,")"))
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 20, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 1, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
df2 <- as.data.frame(rpois(1000, lambda = 5))
colnames(df2) <- "Freq"
df2$dens <- 3 * dpois(x = df2$Freq, lambda = 5)
df2$normdens <- mybinwidth * dnorm(df2$Freq,mean=mean(df2$Freq),sd=sd(df2$Freq))
R2.exp <- expression(paste("assay signal (",10^4,")"))
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) 2.95* dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D",
alpha=0.8)+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="assay signal",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
#scale_x_continuous(breaks = c(99000,99500,100000,100500,101000), labels = c("9.90","9.95","10.00","10.05","10.10"))+
geom_vline(xintercept = 1, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
##################################################################################
#for figure #1 Panel #2 (Poisson distributed data)
##################################################################################
set.seed(111)
mybinwidth = 2.4
df2 <- as.data.frame(rpois(1000, lambda = 10))
colnames(df2) <- "Freq"
df2$dens <- mybinwidth * dpois(x = df2$Freq, lambda = 10)
df2$normdens <- mybinwidth * dnorm(df2$Freq,mean=mean(df2$Freq),sd=sd(df2$Freq))
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=50, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none')
ggplot(df2, aes(Freq)) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=50, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none') +
geom_vline(xintercept = 10, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-2,25) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=50, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none') +
geom_vline(xintercept = 10, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-5,22) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=50, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none') +
geom_vline(xintercept = 10, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-5,22) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=90, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none') +
geom_vline(xintercept = 10, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
ggplot(df2, aes(Freq)) +
xlim(-5,22) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none') +
geom_vline(xintercept = 10, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
mybinwidth = 3
df2$dens <- mybinwidth * dpois(x = df2$Freq, lambda = 10)
df2$normdens <- mybinwidth * dnorm(df2$Freq,mean=mean(df2$Freq),sd=sd(df2$Freq))
ggplot(df2, aes(Freq)) +
xlim(-5,22) +
geom_histogram(aes(y = ..density..), color = "grey",
fill = "white", bins=80, center = 0, size = 1.5) +
geom_line(aes(y=dens), color = "#00BFC4", size = 1.5)+
stat_function(fun = function(x,mean,sd) mybinwidth * dnorm(x,mean, sd),
args=list(mean(df2$Freq),sd(df2$Freq)), size = 1.5, color = "#F8766D")+
theme_classic(base_size = 25) +
scale_fill_manual(values=c('#999999','#E69F00')) +
labs(title="",
x="positive rare events",
y = "density") +
guides(fill=guide_legend(title="Distribution fit")) +
theme(legend.position = 'none') +
geom_vline(xintercept = 10, linetype="dotted",
color = "black", size=1.5)+
theme(legend.position = 'none',
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
plot.margin=unit(c(0.5,1,0.5,0.5),"cm"))
164/32000
16400/32000
shiny::runApp('C:/Users/ayushi/Downloads/graPe/app')
runApp('C:/Users/ayushi/Downloads/graPe/app')
runApp()
runApp('C:/Users/ayushi/Downloads/graPe/app')
runApp()
runApp('C:/Users/ayushi/Downloads/graPe/app')
runApp('C:/Users/ayushi/Downloads/graPe/app')
dat <- read.csv("C:/Users/ayushi/Downloads/grape_manuscript/RowdataTableTOY1.csv")
cols.expected = c("run_id","plate_id","well_id","site_id", "trt","total","count" )
(setequal(colnames(dat),cols.expected)) & (length(colnames(dat)) == length(cols.expected))
runApp('C:/Users/ayushi/Downloads/graPe/app')
dat <- read.csv("C:/Users/ayushi/Downloads/grape_manuscript/RowdataTableTOY1.csv")
head(dat)
x <- run_graPe(dat,"DMSO")
head(x)
qual_output = x[(x$trt == positive.control),
c('run_id',
'plate_id',
'trt',
'zprime_poiss',
'nc.lambdahat.per.plate',
'nc.upperqi.per.plate.spline',
'trt.lambdahat.per.plate',
'trt.lowerqi.per.plate.spline')]
qual_output = x[(x$trt == "cpd1"),
c('run_id',
'plate_id',
'trt',
'zprime_poiss',
'nc.lambdahat.per.plate',
'nc.upperqi.per.plate.spline',
'trt.lambdahat.per.plate',
'trt.lowerqi.per.plate.spline')]
qual_output
round(qual_output,2)
qual_output[,(c('zprime_poiss',
'nc.lambdahat.per.plate',
'nc.upperqi.per.plate.spline',
'trt.lambdahat.per.plate',
'trt.lowerqi.per.plate.spline')) := round(.SD,1), .SDcols=c('zprime_poiss',
'nc.lambdahat.per.plate',
'nc.upperqi.per.plate.spline',
'trt.lambdahat.per.plate',
'trt.lowerqi.per.plate.spline')]
round(qual_output[,c('zprime_poiss',
'nc.lambdahat.per.plate',
'nc.upperqi.per.plate.spline',
'trt.lambdahat.per.plate',
'trt.lowerqi.per.plate.spline')],2)
runApp('C:/Users/ayushi/Downloads/graPe/app')
runApp('C:/Users/ayushi/Downloads/graPe/app')
